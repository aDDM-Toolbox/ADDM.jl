<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model comparison · ADDM.jl</title><meta name="title" content="Model comparison · ADDM.jl"/><meta property="og:title" content="Model comparison · ADDM.jl"/><meta property="twitter:title" content="Model comparison · ADDM.jl"/><meta name="description" content="Documentation for ADDM.jl."/><meta property="og:description" content="Documentation for ADDM.jl."/><meta property="twitter:description" content="Documentation for ADDM.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ADDM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ADDM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../getting_started/">Getting started with ADDM.jl</a></li><li><a class="tocitem" href="../empirical_data/">Parameter estimation on empirical data</a></li><li class="is-active"><a class="tocitem" href>Model comparison</a><ul class="internal"><li><a class="tocitem" href="#Comparing-parameters-of-a-single-generative-processes"><span>Comparing parameters of a single generative processes</span></a></li><li><a class="tocitem" href="#Comparing-different-generative-processes"><span>Comparing different generative processes</span></a></li><li><a class="tocitem" href="#More?"><span>More?</span></a></li></ul></li><li><a class="tocitem" href="../custom_model/">Defining custom models</a></li></ul></li><li><a class="tocitem" href="../../apireference/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Model comparison</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model comparison</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/aDDM-Toolbox/ADDM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/aDDM-Toolbox/ADDM.jl/blob/main/docs/src/tutorials/model_comparison.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-comparison"><a class="docs-heading-anchor" href="#Model-comparison">Model comparison</a><a id="Model-comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Model-comparison" title="Permalink"></a></h1><h2 id="Comparing-parameters-of-a-single-generative-processes"><a class="docs-heading-anchor" href="#Comparing-parameters-of-a-single-generative-processes">Comparing parameters of a single generative processes</a><a id="Comparing-parameters-of-a-single-generative-processes-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-parameters-of-a-single-generative-processes" title="Permalink"></a></h2><h3 id="Posterior-model-probability"><a class="docs-heading-anchor" href="#Posterior-model-probability">Posterior model probability</a><a id="Posterior-model-probability-1"></a><a class="docs-heading-anchor-permalink" href="#Posterior-model-probability" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using ADDM</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using CSV</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFrames</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFramesMeta</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>Read in data from Krajbich et al. (2010)</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; krajbich_data = ADDM.load_data_from_csv(&quot;../../../data/Krajbich2010_behavior.csv&quot;, &quot;../../../data/Krajbich2010_fixations.csv&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{String, Vector{ADDM.Trial}} with 10 entries:
  &quot;14&quot; =&gt; [Trial(-1, 2234, 2, 0, Number[2, 1], Number[399, 737], #undef, #undef…
  &quot;20&quot; =&gt; [Trial(-1, 1991, 4, 2, Number[1, 2, 1], Number[339, 679, 680], #undef…
  &quot;10&quot; =&gt; [Trial(-1, 3808, 4, 2, Number[1, 2, 1, 2, 1, 2, 1], Number[98, 426, 3…
  &quot;17&quot; =&gt; [Trial(-1, 1191, 0, 0, Number[1, 2], Number[340, 638], #undef, #undef…
  &quot;19&quot; =&gt; [Trial(1, 1449, 7, 5, Number[1, 2, 1], Number[258, 677, 99], #undef, …
  &quot;22&quot; =&gt; [Trial(1, 2882, 6, 2, Number[2, 1, 2, 1, 2], Number[259, 797, 595, 57…
  &quot;16&quot; =&gt; [Trial(1, 1251, 5, 5, Number[1, 2], Number[275, 660], #undef, #undef,…
  &quot;11&quot; =&gt; [Trial(-1, 1672, 5, 2, Number[1, 2, 1, 2], Number[338, 440, 319, 380]…
  &quot;13&quot; =&gt; [Trial(1, 3848, 1, 2, Number[1, 2, 1, 2], Number[1036, 757, 997, 757]…
  &quot;18&quot; =&gt; [Trial(-1, 13456, 2, 0, Number[1, 2, 1, 2, 1, 2, 1], Number[637, 2691…</code></pre><p>Run grid search for a single subject. This computes the nll for 64 parameter combinations for a single subject.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; # fn = &quot;./data/Krajbich_grid.csv&quot;
       fn = &quot;../../../data/Krajbich_grid3.csv&quot;</code><code class="nohighlight hljs ansi" style="display:block;">&quot;../../../data/Krajbich_grid3.csv&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; tmp = DataFrame(CSV.File(fn, delim=&quot;,&quot;))</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">64×3 DataFrame
 Row │ d        sigma    theta
     │<span class="sgr90"> Float64  Float64  Float64
─────┼───────────────────────────
   1 │ 0.00055    0.035      0.3
   2 │ 0.00065    0.035      0.3
   3 │ 0.00075    0.035      0.3
   4 │ 0.00085    0.035      0.3
   5 │ 0.00055    0.045      0.3
   6 │ 0.00065    0.045      0.3
   7 │ 0.00075    0.045      0.3
   8 │ 0.00085    0.045      0.3
  ⋮  │    ⋮        ⋮        ⋮
  58 │ 0.00065    0.055      0.9
  59 │ 0.00075    0.055      0.9
  60 │ 0.00085    0.055      0.9
  61 │ 0.00055    0.065      0.9
  62 │ 0.00065    0.065      0.9
  63 │ 0.00075    0.065      0.9
  64 │ 0.00085    0.065      0.9
</span><span class="sgr36">                  49 rows omitted</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; param_grid = Dict(pairs(NamedTuple.(eachrow(tmp))))</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Int64, NamedTuple{(:d, :sigma, :theta), Tuple{Float64, Float64, Float64}}} with 64 entries:
  5  =&gt; (d = 0.00055, sigma = 0.045, theta = 0.3)
  56 =&gt; (d = 0.00085, sigma = 0.045, theta = 0.9)
  16 =&gt; (d = 0.00085, sigma = 0.065, theta = 0.3)
  20 =&gt; (d = 0.00085, sigma = 0.035, theta = 0.5)
  35 =&gt; (d = 0.00075, sigma = 0.035, theta = 0.7)
  55 =&gt; (d = 0.00075, sigma = 0.045, theta = 0.9)
  60 =&gt; (d = 0.00085, sigma = 0.055, theta = 0.9)
  30 =&gt; (d = 0.00065, sigma = 0.065, theta = 0.5)
  19 =&gt; (d = 0.00075, sigma = 0.035, theta = 0.5)
  32 =&gt; (d = 0.00085, sigma = 0.065, theta = 0.5)
  49 =&gt; (d = 0.00055, sigma = 0.035, theta = 0.9)
  6  =&gt; (d = 0.00065, sigma = 0.045, theta = 0.3)
  45 =&gt; (d = 0.00055, sigma = 0.065, theta = 0.7)
  44 =&gt; (d = 0.00085, sigma = 0.055, theta = 0.7)
  9  =&gt; (d = 0.00055, sigma = 0.055, theta = 0.3)
  31 =&gt; (d = 0.00075, sigma = 0.065, theta = 0.5)
  64 =&gt; (d = 0.00085, sigma = 0.065, theta = 0.9)
  61 =&gt; (d = 0.00055, sigma = 0.065, theta = 0.9)
  29 =&gt; (d = 0.00055, sigma = 0.065, theta = 0.5)
  ⋮  =&gt; ⋮</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; my_likelihood_args = (timeStep = 10.0, approxStateStep = 0.01)</code><code class="nohighlight hljs ansi" style="display:block;">(timeStep = 10.0, approxStateStep = 0.01)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; subj_data = krajbich_data[&quot;18&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">100-element Vector{ADDM.Trial}:
 ADDM.Trial(-1, 13456, 2, 0, Number[1, 2, 1, 2, 1, 2, 1], Number[637, 2691, 597, 1595, 1655, 4724, 638], #undef, #undef, #undef)
 ADDM.Trial(-1, 6881, 8, 8, Number[1, 2, 1, 2, 1], Number[797, 818, 1471, 2731, 538], #undef, #undef, #undef)
 ADDM.Trial(1, 3420, 3, 3, Number[1, 2, 1, 2], Number[577, 1217, 837, 558], #undef, #undef, #undef)
 ADDM.Trial(1, 5435, 4, 3, Number[1, 2, 1, 2, 1, 2], Number[558, 637, 678, 1794, 957, 499], #undef, #undef, #undef)
 ADDM.Trial(-1, 3374, 8, 5, Number[1, 2, 1, 2, 1], Number[538, 897, 717, 539, 360], #undef, #undef, #undef)
 ADDM.Trial(-1, 6397, 5, 0, Number[1, 2, 1, 2, 1], Number[577, 1515, 939, 1276, 1773], #undef, #undef, #undef)
 ADDM.Trial(-1, 5665, 5, 5, Number[1, 2, 1, 2, 1, 2], Number[419, 1554, 797, 697, 1016, 956], #undef, #undef, #undef)
 ADDM.Trial(-1, 5557, 4, 5, Number[1, 2, 1, 2, 1], Number[520, 1194, 1276, 1576, 778], #undef, #undef, #undef)
 ADDM.Trial(-1, 4688, 9, 5, Number[1, 2, 1, 2, 1], Number[1953, 757, 478, 583, 693], #undef, #undef, #undef)
 ADDM.Trial(-1, 8984, 6, 2, Number[1, 2, 1, 2, 1, 2, 1, 2, 1], Number[378, 1096, 1376, 1953, 518, 937, 638, 1297, 540], #undef, #undef, #undef)
 ⋮
 ADDM.Trial(-1, 1011, 8, 6, Number[1, 2], Number[259, 538], #undef, #undef, #undef)
 ADDM.Trial(1, 2572, 5, 7, Number[1, 2, 1, 2], Number[458, 499, 897, 480], #undef, #undef, #undef)
 ADDM.Trial(1, 2047, 2, 6, Number[1, 2, 1, 2], Number[180, 577, 897, 203], #undef, #undef, #undef)
 ADDM.Trial(1, 4371, 4, 3, Number[1, 2, 1, 2, 1, 2], Number[259, 218, 498, 2232, 500, 421], #undef, #undef, #undef)
 ADDM.Trial(-1, 4315, 6, 6, Number[1, 2, 1, 2, 1], Number[319, 577, 2352, 681, 80], #undef, #undef, #undef)
 ADDM.Trial(-1, 3592, 7, 5, Number[1, 2, 1, 2], Number[220, 916, 677, 1495], #undef, #undef, #undef)
 ADDM.Trial(1, 1045, 6, 9, Number[1, 2], Number[220, 597], #undef, #undef, #undef)
 ADDM.Trial(-1, 2971, 6, 5, Number[1, 2, 1, 2, 1], Number[179, 1475, 575, 418, 41], #undef, #undef, #undef)
 ADDM.Trial(-1, 3023, 5, 8, Number[1, 2, 1, 2, 1], Number[200, 457, 957, 1057, 99], #undef, #undef, #undef)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; best_pars, nll_df, model_posteriors = ADDM.grid_search(subj_data, ADDM.aDDM_get_trial_likelihood, param_grid,
           Dict(:η=&gt;0.0, :barrier=&gt;1, :decay=&gt;0, :nonDecisionTime=&gt;0, :bias=&gt;0.0),
           likelihood_args=my_likelihood_args,
           return_model_posteriors = true)</code><code class="nohighlight hljs ansi" style="display:block;">(Dict{Symbol, Real}(:nonDecisionTime =&gt; 0, :bias =&gt; 0.0, :d =&gt; 0.00085, :barrier =&gt; 1, :sigma =&gt; 0.055, :theta =&gt; 0.5, :decay =&gt; 0, :η =&gt; 0.0, :nll =&gt; 689.5526924724633), <span class="sgr1">64×4 DataFrame
 Row │ d        sigma    theta    nll
     │<span class="sgr90"> Float64  Float64  Float64  Float64
─────┼────────────────────────────────────
   1 │ 0.00055    0.045      0.3  702.889
   2 │ 0.00085    0.045      0.9  702.251
   3 │ 0.00085    0.065      0.3  700.446
   4 │ 0.00085    0.035      0.5  728.248
   5 │ 0.00075    0.035      0.7  734.463
   6 │ 0.00075    0.045      0.9  703.184
   7 │ 0.00085    0.055      0.9  695.636
   8 │ 0.00065    0.065      0.5  702.858
  ⋮  │    ⋮        ⋮        ⋮        ⋮
  58 │ 0.00075    0.055      0.9  696.333
  59 │ 0.00065    0.035      0.3  736.227
  60 │ 0.00065    0.055      0.3  692.861
  61 │ 0.00065    0.035      0.5  736.226
  62 │ 0.00065    0.055      0.5  693.202
  63 │ 0.00075    0.055      0.5  691.081
  64 │ 0.00065    0.055      0.7  694.802
</span><span class="sgr36">                           49 rows omitted, Dict(5 =&gt; 6.336809352538163e-7, 56 =&gt; 1.1995792633110298e-6, 16 =&gt; 7.298536362522936e-6, 20 =&gt; 6.146094996063664e-18, 35 =&gt; 1.2289789596069789e-20, 55 =&gt; 4.718950147813461e-7, 60 =&gt; 0.0008950027439783302, 30 =&gt; 6.539032842727082e-7, 19 =&gt; 2.248462661533098e-19, 32 =&gt; 9.629476127762702e-6…))</span></span></code></pre><h3 id="Individual-parameter-posteriors"><a class="docs-heading-anchor" href="#Individual-parameter-posteriors">Individual parameter posteriors</a><a id="Individual-parameter-posteriors-1"></a><a class="docs-heading-anchor-permalink" href="#Individual-parameter-posteriors" title="Permalink"></a></h3><p>Merge model posteriors with the model parameters they refer to. This creates a dataframe instead of the <code>model_posteriors</code> dictionary that is easier to make plots with.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; posteriors_df = DataFrame()</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">0×0 DataFrame</span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for (k, v) in param_grid
         cur_row = DataFrame([v])
         cur_row.posterior = [model_posteriors[k]]
         append!(posteriors_df, cur_row)
       end</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>Plot model posteriors. Note the use of <code>@chain</code> and other operations such as <code>@rsubset</code> etc. for <code>dplyr</code> like functionality in Julia through <code>DataFrameMeta.jl</code>.  </p><p>Note also that we&#39;re only plotting the posteriors for models that have a meaningful amount of probability mass instead of all the 64 models that were tested.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot_df = @chain posteriors_df begin
         @rsubset :posterior &gt; 1e-10
         @rtransform :x_label = &quot;d: &quot; * string(:d) * &quot;, \nσ: &quot; * string(:sigma) * &quot;, \nθ: &quot; * string(:theta)
         @orderby -:posterior
         end</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">48×5 DataFrame
 Row │ d        sigma    theta    posterior   x_label                          ⋯
     │<span class="sgr90"> Float64  Float64  Float64  Float64     String                           ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 0.00085    0.055      0.5  0.392581    d: 0.00085, \nσ: 0.055, \nθ: 0.5 ⋯
   2 │ 0.00085    0.055      0.3  0.321245    d: 0.00085, \nσ: 0.055, \nθ: 0.3
   3 │ 0.00075    0.055      0.3  0.0950647   d: 0.00075, \nσ: 0.055, \nθ: 0.3
   4 │ 0.00075    0.055      0.5  0.0851215   d: 0.00075, \nσ: 0.055, \nθ: 0.5
   5 │ 0.00085    0.055      0.7  0.0547531   d: 0.00085, \nσ: 0.055, \nθ: 0.7 ⋯
   6 │ 0.00065    0.055      0.3  0.0143631   d: 0.00065, \nσ: 0.055, \nθ: 0.3
   7 │ 0.00075    0.055      0.7  0.0141713   d: 0.00075, \nσ: 0.055, \nθ: 0.7
   8 │ 0.00065    0.055      0.5  0.0102092   d: 0.00065, \nσ: 0.055, \nθ: 0.5
  ⋮  │    ⋮        ⋮        ⋮         ⋮                      ⋮                 ⋱
  42 │ 0.00055    0.045      0.7  7.54304e-8  d: 0.00055, \nσ: 0.045, \nθ: 0.7 ⋯
  43 │ 0.00065    0.045      0.9  7.34053e-8  d: 0.00065, \nσ: 0.045, \nθ: 0.9
  44 │ 0.00075    0.065      0.9  4.61411e-8  d: 0.00075, \nσ: 0.065, \nθ: 0.9
  45 │ 0.00055    0.065      0.7  2.71958e-8  d: 0.00055, \nσ: 0.065, \nθ: 0.7
  46 │ 0.00065    0.065      0.9  1.70487e-8  d: 0.00065, \nσ: 0.065, \nθ: 0.9 ⋯
  47 │ 0.00055    0.045      0.9  4.51506e-9  d: 0.00055, \nσ: 0.045, \nθ: 0.9
  48 │ 0.00055    0.065      0.9  4.03303e-9  d: 0.00055, \nσ: 0.065, \nθ: 0.9
</span><span class="sgr36">                                                                33 rows omitted</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @df plot_df bar(:x_label, :posterior, legend = false, xrotation = 45, ylabel = &quot;p(model|data)&quot;,bottom_margin = (5, :mm))</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><img src="../plot3.png" alt="plot"/></p><h3 id="Marginal-posteriors-for-parameters"><a class="docs-heading-anchor" href="#Marginal-posteriors-for-parameters">Marginal posteriors for parameters</a><a id="Marginal-posteriors-for-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Marginal-posteriors-for-parameters" title="Permalink"></a></h3><p>Compute and plot posteriors for each parameter</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; param_posteriors = ADDM.marginal_posteriors(param_grid, model_posteriors)</code><code class="nohighlight hljs ansi" style="display:block;">3-element Vector{Any}:
 <span class="sgr1">4×2 DataFrame
 Row │ d        posterior_sum
     │<span class="sgr90"> Float64  Float64
─────┼────────────────────────
   1 │ 0.00055     0.00197559
   2 │ 0.00085     0.775586
   3 │ 0.00075     0.195637
   4 │ 0.00065     0.0268011
 4×2 DataFrame
 Row │ sigma    posterior_sum
     │ Float64  Float64
─────┼────────────────────────
   1 │   0.045    0.00696685
   2 │   0.065    2.82679e-5
   3 │   0.035    9.57592e-18
   4 │   0.055    0.993005
 4×2 DataFrame
 Row │ theta    posterior_sum
     │ Float64  Float64
─────┼────────────────────────
   1 │     0.3     0.434736
   2 │     0.9     0.00147894
   3 │     0.5     0.49233
   4 │     0.7     0.0714554</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot_array = Any[]</code><code class="nohighlight hljs ansi" style="display:block;">Any[]</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for plot_df in param_posteriors
         x_lab = names(plot_df)[1]
         cur_plot = @df plot_df bar(plot_df[:, x_lab], :posterior_sum, leg = false, ylabel = &quot;p(&quot; * x_lab * &quot; = x|data)&quot;, xlabel = x_lab )
         push!(plot_array, cur_plot)
       end</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(plot_array...)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><img src="../plot4.png" alt="plot"/></p><p>Compute and plot marginal posteriors with heatmaps</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; marginal_posteriors = ADDM.marginal_posteriors(param_grid, model_posteriors, true)</code><code class="nohighlight hljs ansi" style="display:block;">6-element Vector{Any}:
 <span class="sgr1">4×2 DataFrame
 Row │ d        posterior_sum
     │<span class="sgr90"> Float64  Float64
─────┼────────────────────────
   1 │ 0.00055     0.00197559
   2 │ 0.00085     0.775586
   3 │ 0.00075     0.195637
   4 │ 0.00065     0.0268011
 4×2 DataFrame
 Row │ sigma    posterior_sum
     │ Float64  Float64
─────┼────────────────────────
   1 │   0.045    0.00696685
   2 │   0.065    2.82679e-5
   3 │   0.035    9.57592e-18
   4 │   0.055    0.993005
 4×2 DataFrame
 Row │ theta    posterior_sum
     │ Float64  Float64
─────┼────────────────────────
   1 │     0.3     0.434736
   2 │     0.9     0.00147894
   3 │     0.5     0.49233
   4 │     0.7     0.0714554
 16×3 DataFrame
 Row │ d        sigma    posterior_sum
     │ Float64  Float64  Float64
─────┼─────────────────────────────────
   1 │ 0.00055    0.045    1.10675e-6
   2 │ 0.00085    0.045    0.00609219
   3 │ 0.00085    0.065    1.91349e-5
   4 │ 0.00085    0.035    9.17379e-18
   5 │ 0.00075    0.035    3.97713e-19
   6 │ 0.00075    0.045    0.000826574
   7 │ 0.00085    0.055    0.769475
   8 │ 0.00065    0.065    1.70294e-6
   9 │ 0.00055    0.035    1.22467e-23
  10 │ 0.00065    0.045    4.69828e-5
  11 │ 0.00055    0.065    2.53055e-7
  12 │ 0.00055    0.055    0.00197423
  13 │ 0.00075    0.065    7.17705e-6
  14 │ 0.00065    0.055    0.0267524
  15 │ 0.00075    0.055    0.194803
  16 │ 0.00065    0.035    4.40377e-21
 16×3 DataFrame
 Row │ d        theta    posterior_sum
     │ Float64  Float64  Float64
─────┼─────────────────────────────────
   1 │ 0.00055      0.3    0.00111171
   2 │ 0.00085      0.9    0.000896282
   3 │ 0.00085      0.3    0.323762
   4 │ 0.00085      0.5    0.395917
   5 │ 0.00075      0.7    0.0142119
   6 │ 0.00075      0.9    0.000446247
   7 │ 0.00065      0.5    0.0102286
   8 │ 0.00075      0.5    0.0855065
   9 │ 0.00055      0.9    1.71243e-5
  10 │ 0.00065      0.3    0.0143895
  11 │ 0.00055      0.7    0.000168505
  12 │ 0.00085      0.7    0.0550113
  13 │ 0.00055      0.5    0.000678258
  14 │ 0.00065      0.7    0.00206368
  15 │ 0.00065      0.9    0.000119287
  16 │ 0.00075      0.3    0.0954724
 16×3 DataFrame
 Row │ sigma    theta    posterior_sum
     │ Float64  Float64  Float64
─────┼─────────────────────────────────
   1 │   0.045      0.3    0.00293996
   2 │   0.045      0.9    1.74939e-6
   3 │   0.065      0.3    1.15284e-5
   4 │   0.035      0.5    6.37305e-18
   5 │   0.035      0.7    2.13653e-19
   6 │   0.055      0.9    0.00147704
   7 │   0.065      0.5    1.35042e-5
   8 │   0.035      0.9    1.38075e-22
   9 │   0.065      0.7    3.0881e-6
  10 │   0.055      0.7    0.0711537
  11 │   0.055      0.3    0.431784
  12 │   0.065      0.9    1.47174e-7
  13 │   0.035      0.3    2.98907e-18
  14 │   0.045      0.5    0.00372656
  15 │   0.045      0.7    0.000298579
  16 │   0.055      0.5    0.48859</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ADDM.margpostplot(marginal_posteriors)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=6}</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><img src="../plot5.png" alt="plot"/></p><h2 id="Comparing-different-generative-processes"><a class="docs-heading-anchor" href="#Comparing-different-generative-processes">Comparing different generative processes</a><a id="Comparing-different-generative-processes-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-different-generative-processes" title="Permalink"></a></h2><ol><li>Estimate best fitting parameters separately for each process  <ul><li>Is this necessary? Do uou only need trial likelihoods and priors for each model (that are indexed in a way that leaves no ambiguity about which model generated with trial likelihoods)</li><li>You can&#39;t compute marginal parameter distributions across different generative processes (I don&#39;t think) but you could compare the two best fitting parameter combinations from one generative process to an entirely different generative process, as long as you have the trial likelihoods for each model.  </li></ul></li><li>Compute trial likelihoods plugging in best fitting parameters  </li><li>Compute model posterior using trial likelihoods  <ul><li>Does this violate any assumptions?</li></ul></li></ol><h2 id="More?"><a class="docs-heading-anchor" href="#More?">More?</a><a id="More?-1"></a><a class="docs-heading-anchor-permalink" href="#More?" title="Permalink"></a></h2><ul><li>True vs. simulated data<ul><li>RT distributions conditional on choice</li></ul></li><li>Cross-validation?</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../empirical_data/">« Parameter estimation on empirical data</a><a class="docs-footer-nextpage" href="../custom_model/">Defining custom models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 2 February 2024 19:09">Friday 2 February 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
