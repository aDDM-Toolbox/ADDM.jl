<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Uncertainty in the best fitting parameters of a single generative process · ADDM.jl</title><meta name="title" content="Uncertainty in the best fitting parameters of a single generative process · ADDM.jl"/><meta property="og:title" content="Uncertainty in the best fitting parameters of a single generative process · ADDM.jl"/><meta property="twitter:title" content="Uncertainty in the best fitting parameters of a single generative process · ADDM.jl"/><meta name="description" content="Documentation for ADDM.jl."/><meta property="og:description" content="Documentation for ADDM.jl."/><meta property="twitter:description" content="Documentation for ADDM.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ADDM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ADDM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../getting_started/">Getting started with ADDM.jl</a></li><li><a class="tocitem" href="../empirical_data/">Parameter estimation on empirical data</a></li><li><a class="tocitem" href="../custom_model/">Defining custom models</a></li><li class="is-active"><a class="tocitem" href>Uncertainty in the best fitting parameters of a single generative process</a><ul class="internal"><li><a class="tocitem" href="#Posterior-model-probability"><span>Posterior model probability</span></a></li><li><a class="tocitem" href="#Marginal-posteriors-for-parameters"><span>Marginal posteriors for parameters</span></a></li><li class="toplevel"><a class="tocitem" href="#Comparing-fit-of-different-generative-processes"><span>Comparing fit of different generative processes</span></a></li><li><a class="tocitem" href="#Estimate-best-fitting-parameters-separately-for-each-process"><span>Estimate best fitting parameters separately for each process</span></a></li><li><a class="tocitem" href="#Compute-trial-likelihoods-plugging-in-best-fitting-parameters"><span>Compute trial likelihoods plugging in best fitting parameters</span></a></li><li class="toplevel"><a class="tocitem" href="#True-vs.-simulated-data"><span>True vs. simulated data</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../apireference/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Uncertainty in the best fitting parameters of a single generative process</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Uncertainty in the best fitting parameters of a single generative process</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/aDDM-Toolbox/ADDM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/aDDM-Toolbox/ADDM.jl/blob/main/docs/src/tutorials/model_comparison.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Uncertainty-in-the-best-fitting-parameters-of-a-single-generative-process"><a class="docs-heading-anchor" href="#Uncertainty-in-the-best-fitting-parameters-of-a-single-generative-process">Uncertainty in the best fitting parameters of a single generative process</a><a id="Uncertainty-in-the-best-fitting-parameters-of-a-single-generative-process-1"></a><a class="docs-heading-anchor-permalink" href="#Uncertainty-in-the-best-fitting-parameters-of-a-single-generative-process" title="Permalink"></a></h1><h2 id="Posterior-model-probability"><a class="docs-heading-anchor" href="#Posterior-model-probability">Posterior model probability</a><a id="Posterior-model-probability-1"></a><a class="docs-heading-anchor-permalink" href="#Posterior-model-probability" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using ADDM</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using CSV</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFrames</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFramesMeta</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: ArgumentError: Package DataFramesMeta not found in current path:
- Run `import Pkg; Pkg.add(&quot;DataFramesMeta&quot;)` to install the DataFramesMeta package.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>Read in data from Krajbich et al. (2010)</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; krajbich_data = ADDM.load_data_from_csv(&quot;./data/Krajbich2010_behavior.csv&quot;, &quot;./data/Krajbich2010_fixations.csv&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Error while reading experimental data file ./data/Krajbich2010_behavior.csv</code></pre><p>Run grid search for a single subject. This computes the nll for 64 parameter combinations for a single subject.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; # fn = &quot;./data/Krajbich_grid.csv&quot;
       fn = &quot;./data/Krajbich_grid3.csv&quot;</code><code class="nohighlight hljs ansi" style="display:block;">&quot;./data/Krajbich_grid3.csv&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; tmp = DataFrame(CSV.File(fn, delim=&quot;,&quot;))</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: ArgumentError: &quot;./data/Krajbich_grid3.csv&quot; is not a valid file or doesn&#39;t exist</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; param_grid = Dict(pairs(NamedTuple.(eachrow(tmp))))</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: tmp not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; my_likelihood_args = (timeStep = 10.0, approxStateStep = 0.01)</code><code class="nohighlight hljs ansi" style="display:block;">(timeStep = 10.0, approxStateStep = 0.01)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; subj_data = krajbich_data[&quot;18&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: MethodError: no method matching getindex(::Nothing, ::String)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; best_pars, nll_df, model_posteriors = ADDM.grid_search(subj_data, ADDM.aDDM_get_trial_likelihood, param_grid,
           Dict(:η=&gt;0.0, :barrier=&gt;1, :decay=&gt;0, :nonDecisionTime=&gt;0, :bias=&gt;0.0),
           likelihood_args=my_likelihood_args,
           return_model_posteriors = true)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: subj_data not defined</code></pre><p>Merge model posteriors with the model parameters they refer to. This creates a dataframe instead of the <code>model_posteriors</code> dictionary that is easier to make plots with.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; posteriors_df = DataFrame()</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">0×0 DataFrame</span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for (k, v) in param_grid
         cur_row = DataFrame([v])
         cur_row.posterior = [model_posteriors[k]]
         append!(posteriors_df, cur_row)
       end</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: param_grid not defined</code></pre><p>Plot model posteriors. Note the use of <code>@chain</code> and other operations such as <code>@rsubset</code> etc. for <code>dplyr</code> like functionality in Julia through <code>DataFrameMeta.jl</code>.  </p><p>Note also that we&#39;re only plotting the posteriors for models that have a meaningful amount of probability mass instead of all the 64 models that were tested.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot_df = @chain posteriors_df begin
         @rsubset :posterior &gt; 1e-10
         @rtransform :x_label = &quot;d: &quot; * string(:d) * &quot;, \nσ: &quot; * string(:sigma) * &quot;, \nθ: &quot; * string(:theta)
         @orderby -:posterior
         end</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: LoadError: UndefVarError: @chain not defined
in expression starting at REPL[1]:1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @df plot_df bar(:x_label, :posterior, legend = false, xrotation = 45, ylabel = &quot;p(model|data)&quot;,bottom_margin = (5, :mm))</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: plot_df not defined</code></pre><h2 id="Marginal-posteriors-for-parameters"><a class="docs-heading-anchor" href="#Marginal-posteriors-for-parameters">Marginal posteriors for parameters</a><a id="Marginal-posteriors-for-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Marginal-posteriors-for-parameters" title="Permalink"></a></h2><p>Compute and plot posteriors for each parameter</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; param_posteriors = ADDM.marginal_posteriors(param_grid, model_posteriors)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: param_grid not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot_array = Any[]</code><code class="nohighlight hljs ansi" style="display:block;">Any[]</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for plot_df in param_posteriors
         x_lab = names(plot_df)[1]
         cur_plot = @df plot_df bar(plot_df[:, x_lab], :posterior_sum, leg = false, ylabel = &quot;p(&quot; * x_lab * &quot; = x|data)&quot;, xlabel = x_lab )
         push!(plot_array, cur_plot)
       end</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: param_posteriors not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(plot_array...)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=0}</code></pre><p>Compute and plot marginal posteriors with heatmaps</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; marginal_posteriors = ADDM.marginal_posteriors(param_grid, model_posteriors, true)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: param_grid not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; margpostplot(marginal_posteriors)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: marginal_posteriors not defined</code></pre><h1 id="Comparing-fit-of-different-generative-processes"><a class="docs-heading-anchor" href="#Comparing-fit-of-different-generative-processes">Comparing fit of different generative processes</a><a id="Comparing-fit-of-different-generative-processes-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-fit-of-different-generative-processes" title="Permalink"></a></h1><h2 id="Estimate-best-fitting-parameters-separately-for-each-process"><a class="docs-heading-anchor" href="#Estimate-best-fitting-parameters-separately-for-each-process">Estimate best fitting parameters separately for each process</a><a id="Estimate-best-fitting-parameters-separately-for-each-process-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-best-fitting-parameters-separately-for-each-process" title="Permalink"></a></h2><p>This isn&#39;t actually necessary. You only need trial likelihoods and priors for each model that are indexed in a way that leaves no ambiguity about which model generated with trial likelihoods</p><p>You can&#39;t compute marginal parameter distributions across different generative processes (I don&#39;t think) but you could compare the two best fitting parameter combinations from one generative process to an entirely different generative process, as long as you have the trial likelihoods for each model.</p><h2 id="Compute-trial-likelihoods-plugging-in-best-fitting-parameters"><a class="docs-heading-anchor" href="#Compute-trial-likelihoods-plugging-in-best-fitting-parameters">Compute trial likelihoods plugging in best fitting parameters</a><a id="Compute-trial-likelihoods-plugging-in-best-fitting-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-trial-likelihoods-plugging-in-best-fitting-parameters" title="Permalink"></a></h2><h1 id="True-vs.-simulated-data"><a class="docs-heading-anchor" href="#True-vs.-simulated-data">True vs. simulated data</a><a id="True-vs.-simulated-data-1"></a><a class="docs-heading-anchor-permalink" href="#True-vs.-simulated-data" title="Permalink"></a></h1></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../custom_model/">« Defining custom models</a><a class="docs-footer-nextpage" href="../../apireference/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 1 February 2024 19:23">Thursday 1 February 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
