<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parameter estimation on empirical data · ADDM.jl</title><meta name="title" content="Parameter estimation on empirical data · ADDM.jl"/><meta property="og:title" content="Parameter estimation on empirical data · ADDM.jl"/><meta property="twitter:title" content="Parameter estimation on empirical data · ADDM.jl"/><meta name="description" content="Documentation for ADDM.jl."/><meta property="og:description" content="Documentation for ADDM.jl."/><meta property="twitter:description" content="Documentation for ADDM.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ADDM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ADDM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../getting_started/">Getting started with ADDM.jl</a></li><li class="is-active"><a class="tocitem" href>Parameter estimation on empirical data</a><ul class="internal"><li><a class="tocitem" href="#Load-packages"><span>Load packages</span></a></li><li><a class="tocitem" href="#Read-in-data"><span>Read in data</span></a></li><li><a class="tocitem" href="#Grid-search"><span>Grid search</span></a></li></ul></li><li><a class="tocitem" href="../custom_model/">Defining custom models</a></li><li><a class="tocitem" href="../model_comparison/">Model comparison</a></li></ul></li><li><a class="tocitem" href="../../apireference/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Parameter estimation on empirical data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parameter estimation on empirical data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/aDDM-Toolbox/ADDM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/aDDM-Toolbox/ADDM.jl/blob/main/docs/src/tutorials/empirical_data.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Parameter-estimation-on-empirical-data"><a class="docs-heading-anchor" href="#Parameter-estimation-on-empirical-data">Parameter estimation on empirical data</a><a id="Parameter-estimation-on-empirical-data-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-estimation-on-empirical-data" title="Permalink"></a></h1><h2 id="Load-packages"><a class="docs-heading-anchor" href="#Load-packages">Load packages</a><a id="Load-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-packages" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using ADDM</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using CSV</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFrames</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><h2 id="Read-in-data"><a class="docs-heading-anchor" href="#Read-in-data">Read in data</a><a id="Read-in-data-1"></a><a class="docs-heading-anchor-permalink" href="#Read-in-data" title="Permalink"></a></h2><p>Data in this tutorial are from 10 subjects in Kraijbich et al (2010). We will use the built-in data loading function <code>ADDM.load_data_from_csv</code> that expects a behavioral file with columns <code>parcode, trial, rt, choice, item_left, item_right</code> and fixations file with columns <code>parcode, trial, fix_item, fix_time</code></p><p>If your data is not organized in this way you could either preprocess it so it does or you can read in the data however you want and reshape it with Julia to ensure it is organized as a dictionary of <code>Trial</code> objects <em>indexed by subject/parcode</em>. A <code>Trial</code> looks like</p><pre><code class="nohighlight hljs">ADDM.Trial(1, 1474.0, -5, 5, Number[3, 0, 1, 0, 2, 0], Number[270.0, 42.0, 246.0, 62.0, 558.0, 296.0], #undef, #undef, #undef)</code></pre><p>where the first element is choice (-1 for left, +1 for right), second element is response time in ms, third is value of left option, fourth is value of right option. Fixation data is specified in the fourth and fifth elements as fixation location (1 for left, 2 for right) and fixation duration (in ms) respectively.  </p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; krajbich_data = ADDM.load_data_from_csv(&quot;../../../data/Krajbich2010_behavior.csv&quot;, &quot;../../../data/Krajbich2010_fixations.csv&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{String, Vector{ADDM.Trial}} with 10 entries:
  &quot;14&quot; =&gt; [Trial(-1, 2234, 2, 0, Number[2, 1], Number[399, 737], #undef, #undef…
  &quot;20&quot; =&gt; [Trial(-1, 1991, 4, 2, Number[1, 2, 1], Number[339, 679, 680], #undef…
  &quot;10&quot; =&gt; [Trial(-1, 3808, 4, 2, Number[1, 2, 1, 2, 1, 2, 1], Number[98, 426, 3…
  &quot;17&quot; =&gt; [Trial(-1, 1191, 0, 0, Number[1, 2], Number[340, 638], #undef, #undef…
  &quot;19&quot; =&gt; [Trial(1, 1449, 7, 5, Number[1, 2, 1], Number[258, 677, 99], #undef, …
  &quot;22&quot; =&gt; [Trial(1, 2882, 6, 2, Number[2, 1, 2, 1, 2], Number[259, 797, 595, 57…
  &quot;16&quot; =&gt; [Trial(1, 1251, 5, 5, Number[1, 2], Number[275, 660], #undef, #undef,…
  &quot;11&quot; =&gt; [Trial(-1, 1672, 5, 2, Number[1, 2, 1, 2], Number[338, 440, 319, 380]…
  &quot;13&quot; =&gt; [Trial(1, 3848, 1, 2, Number[1, 2, 1, 2], Number[1036, 757, 997, 757]…
  &quot;18&quot; =&gt; [Trial(-1, 13456, 2, 0, Number[1, 2, 1, 2, 1, 2, 1], Number[637, 2691…</code></pre><h2 id="Grid-search"><a class="docs-heading-anchor" href="#Grid-search">Grid search</a><a id="Grid-search-1"></a><a class="docs-heading-anchor-permalink" href="#Grid-search" title="Permalink"></a></h2><p>Using a grid of 64 parameter combinations with <code>d</code> in {0.0001, 0.00015, 0.0002, 0.00025}, <code>μ</code> in {80, 100, 120, 140}, <code>θ</code> in {0.3, 0.5, 0.7, 0.9}  and <code>σ = d*μ</code>   </p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; fn = &quot;../../../data/Krajbich_grid.csv&quot;</code><code class="nohighlight hljs ansi" style="display:block;">&quot;../../../data/Krajbich_grid.csv&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; tmp = DataFrame(CSV.File(fn, delim=&quot;,&quot;))</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">64×3 DataFrame
 Row │ d        sigma    theta
     │<span class="sgr90"> Float64  Float64  Float64
─────┼───────────────────────────
   1 │ 0.0001     0.008      0.3
   2 │ 0.00015    0.012      0.3
   3 │ 0.0002     0.016      0.3
   4 │ 0.00025    0.02       0.3
   5 │ 0.0001     0.01       0.3
   6 │ 0.00015    0.015      0.3
   7 │ 0.0002     0.02       0.3
   8 │ 0.00025    0.025      0.3
  ⋮  │    ⋮        ⋮        ⋮
  58 │ 0.00015    0.018      0.9
  59 │ 0.0002     0.024      0.9
  60 │ 0.00025    0.03       0.9
  61 │ 0.0001     0.014      0.9
  62 │ 0.00015    0.021      0.9
  63 │ 0.0002     0.028      0.9
  64 │ 0.00025    0.035      0.9
</span><span class="sgr36">                  49 rows omitted</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; param_grid = Dict(pairs(NamedTuple.(eachrow(tmp))))</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Int64, NamedTuple{(:d, :sigma, :theta), Tuple{Float64, Float64, Float64}}} with 64 entries:
  5  =&gt; (d = 0.0001, sigma = 0.01, theta = 0.3)
  56 =&gt; (d = 0.00025, sigma = 0.025, theta = 0.9)
  16 =&gt; (d = 0.00025, sigma = 0.035, theta = 0.3)
  20 =&gt; (d = 0.00025, sigma = 0.02, theta = 0.5)
  35 =&gt; (d = 0.0002, sigma = 0.016, theta = 0.7)
  55 =&gt; (d = 0.0002, sigma = 0.02, theta = 0.9)
  60 =&gt; (d = 0.00025, sigma = 0.03, theta = 0.9)
  30 =&gt; (d = 0.00015, sigma = 0.021, theta = 0.5)
  19 =&gt; (d = 0.0002, sigma = 0.016, theta = 0.5)
  32 =&gt; (d = 0.00025, sigma = 0.035, theta = 0.5)
  49 =&gt; (d = 0.0001, sigma = 0.008, theta = 0.9)
  6  =&gt; (d = 0.00015, sigma = 0.015, theta = 0.3)
  45 =&gt; (d = 0.0001, sigma = 0.014, theta = 0.7)
  44 =&gt; (d = 0.00025, sigma = 0.03, theta = 0.7)
  9  =&gt; (d = 0.0001, sigma = 0.012, theta = 0.3)
  31 =&gt; (d = 0.0002, sigma = 0.028, theta = 0.5)
  64 =&gt; (d = 0.00025, sigma = 0.035, theta = 0.9)
  61 =&gt; (d = 0.0001, sigma = 0.014, theta = 0.9)
  29 =&gt; (d = 0.0001, sigma = 0.014, theta = 0.5)
  ⋮  =&gt; ⋮</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; all_nll_df = DataFrame()</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">0×0 DataFrame</span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; best_pars = Dict()</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Any, Any}()</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for k in keys(krajbich_data)
         cur_subj_data = krajbich_data[k]
       
         subj_best_pars, subj_nll_df = ADDM.grid_search(cur_subj_data, ADDM.aDDM_get_trial_likelihood, param_grid, Dict(:η=&gt;0.0, :barrier=&gt;1, :decay=&gt;0, :nonDecisionTime=&gt;0, :bias=&gt;0.0))
       
         best_pars[k] = subj_best_pars
       
         subj_nll_df[!, &quot;parcode&quot;] .= k
         append!(all_nll_df, subj_nll_df)
       
       end</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>To view best parameter estimates for each subject</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; best_pars</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Any, Any} with 10 entries:
  &quot;18&quot; =&gt; Dict{Symbol, Real}(:nonDecisionTime=&gt;0, :bias=&gt;0.0, :d=&gt;0.00025, :bar…
  &quot;20&quot; =&gt; Dict{Symbol, Real}(:nonDecisionTime=&gt;0, :bias=&gt;0.0, :d=&gt;0.00025, :bar…
  &quot;10&quot; =&gt; Dict{Symbol, Real}(:nonDecisionTime=&gt;0, :bias=&gt;0.0, :d=&gt;0.00025, :bar…
  &quot;17&quot; =&gt; Dict{Symbol, Real}(:nonDecisionTime=&gt;0, :bias=&gt;0.0, :d=&gt;0.00025, :bar…
  &quot;19&quot; =&gt; Dict{Symbol, Real}(:nonDecisionTime=&gt;0, :bias=&gt;0.0, :d=&gt;0.00025, :bar…
  &quot;22&quot; =&gt; Dict{Symbol, Real}(:nonDecisionTime=&gt;0, :bias=&gt;0.0, :d=&gt;0.00025, :bar…
  &quot;16&quot; =&gt; Dict{Symbol, Real}(:nonDecisionTime=&gt;0, :bias=&gt;0.0, :d=&gt;0.00025, :bar…
  &quot;11&quot; =&gt; Dict{Symbol, Real}(:nonDecisionTime=&gt;0, :bias=&gt;0.0, :d=&gt;0.00025, :bar…
  &quot;13&quot; =&gt; Dict{Symbol, Real}(:nonDecisionTime=&gt;0, :bias=&gt;0.0, :d=&gt;0.00025, :bar…
  &quot;14&quot; =&gt; Dict{Symbol, Real}(:nonDecisionTime=&gt;0, :bias=&gt;0.0, :d=&gt;0.00025, :bar…</code></pre><p>Plot variability in the negative log likelihoods for each parameter combination for each subject</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; wide_nll_df = unstack(all_nll_df, :parcode, :nll)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">64×13 DataFrame
 Row │ d        sigma    theta    14        20        10        17        19   ⋯
     │<span class="sgr90"> Float64  Float64  Float64  Float64?  Float64?  Float64?  Float64?  Floa ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 0.0001     0.01       0.3  12968.2   14736.5   13410.3   14736.5   1473 ⋯
   2 │ 0.00025    0.025      0.9   4064.17   4554.15   4050.76   4643.34   424
   3 │ 0.00025    0.035      0.3   1230.28   1349.71   1208.65   1390.27   115
   4 │ 0.00025    0.02       0.5   7751.85   8728.38   7842.11   8843.02   839
   5 │ 0.0002     0.016      0.7  12949.3   14712.7   13315.6   14729.8   1468 ⋯
   6 │ 0.0002     0.02       0.9   7759.83   8745.2    7858.23   8845.45   843
   7 │ 0.00025    0.03       0.9   2154.9    2393.87   2113.2    2461.3    211
   8 │ 0.00015    0.021      0.5   6813.61   7686.71   6902.2    7771.7    736
  ⋮  │    ⋮        ⋮        ⋮        ⋮         ⋮         ⋮         ⋮         ⋮ ⋱
  58 │ 0.0002     0.024      0.9   4624.5    5195.7    4634.38   5280.26   488 ⋯
  59 │ 0.00015    0.012      0.3  12968.2   14736.5   13410.3   14736.5   1473
  60 │ 0.00015    0.018      0.3  10178.7   11501.1   10370.1   11599.8   1116
  61 │ 0.00015    0.012      0.5  12968.2   14736.5   13410.3   14736.5   1473
  62 │ 0.00015    0.018      0.5  10178.6   11500.2   10369.2   11597.9   1117 ⋯
  63 │ 0.0002     0.024      0.5   4625.16   5199.07   4640.09   5284.22   487
  64 │ 0.00015    0.018      0.7  10178.3   11498.7   10366.7   11595.5   1117
</span><span class="sgr36">                                                   6 columns and 49 rows omitted</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; select!(wide_nll_df, Not([:d, :sigma, :theta]))</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">64×10 DataFrame
 Row │ 14        20        10        17        19        22        16        1 ⋯
     │<span class="sgr90"> Float64?  Float64?  Float64?  Float64?  Float64?  Float64?  Float64?  F ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 12968.2   14736.5   13410.3   14736.5   14736.5   14736.5   14736.5   1 ⋯
   2 │  4064.17   4554.15   4050.76   4643.34   4243.8    4145.82   4459.22
   3 │  1230.28   1349.71   1208.65   1390.27   1151.13   1133.78   1310.57
   4 │  7751.85   8728.38   7842.11   8843.02   8393.8    8292.63   8601.27
   5 │ 12949.3   14712.7   13315.6   14729.8   14680.7   14588.9   14639.9   1 ⋯
   6 │  7759.83   8745.2    7858.23   8845.45   8431.19   8327.79   8645.86
   7 │  2154.9    2393.87   2113.2    2461.3    2118.81   2050.34   2323.26
   8 │  6813.61   7686.71   6902.2    7771.7    7360.3    7262.34   7577.06
  ⋮  │    ⋮         ⋮         ⋮         ⋮         ⋮         ⋮         ⋮        ⋱
  58 │  4624.5    5195.7    4634.38   5280.26   4882.57   4783.63   5099.91    ⋯
  59 │ 12968.2   14736.5   13410.3   14736.5   14736.5   14736.5   14736.5   1
  60 │ 10178.7   11501.1   10370.1   11599.8   11162.4   11064.2   11373.2   1
  61 │ 12968.2   14736.5   13410.3   14736.5   14736.5   14736.5   14736.5   1
  62 │ 10178.6   11500.2   10369.2   11597.9   11170.4   11071.1   11383.4   1 ⋯
  63 │  4625.16   5199.07   4640.09   5284.22   4874.81   4778.72   5090.62
  64 │ 10178.3   11498.7   10366.7   11595.5   11176.9   11076.0   11391.5   1
</span><span class="sgr36">                                                   3 columns and 49 rows omitted</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; colnames = names(wide_nll_df)</code><code class="nohighlight hljs ansi" style="display:block;">10-element Vector{String}:
 &quot;14&quot;
 &quot;20&quot;
 &quot;10&quot;
 &quot;17&quot;
 &quot;19&quot;
 &quot;22&quot;
 &quot;16&quot;
 &quot;11&quot;
 &quot;13&quot;
 &quot;18&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; colnames = string.(&quot;subj-&quot;, colnames)</code><code class="nohighlight hljs ansi" style="display:block;">10-element Vector{String}:
 &quot;subj-14&quot;
 &quot;subj-20&quot;
 &quot;subj-10&quot;
 &quot;subj-17&quot;
 &quot;subj-19&quot;
 &quot;subj-22&quot;
 &quot;subj-16&quot;
 &quot;subj-11&quot;
 &quot;subj-13&quot;
 &quot;subj-18&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; N = length(colnames)</code><code class="nohighlight hljs ansi" style="display:block;">10</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @df wide_nll_df histogram(cols(1:N); layout=grid(2,5), legend=false, title=permutedims(colnames), frame=:box, titlefontsize=11, c=:blues, bins = 20, size=(1800,1000), xrotation = 45)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=10}</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><img src="../plot1.png" alt="plot"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting started with ADDM.jl</a><a class="docs-footer-nextpage" href="../custom_model/">Defining custom models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 2 February 2024 18:17">Friday 2 February 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
