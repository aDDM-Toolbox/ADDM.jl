<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Likelihood computation in ADDM.jl · ADDM.jl</title><meta name="title" content="Likelihood computation in ADDM.jl · ADDM.jl"/><meta property="og:title" content="Likelihood computation in ADDM.jl · ADDM.jl"/><meta property="twitter:title" content="Likelihood computation in ADDM.jl · ADDM.jl"/><meta name="description" content="Documentation for ADDM.jl."/><meta property="og:description" content="Documentation for ADDM.jl."/><meta property="twitter:description" content="Documentation for ADDM.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ADDM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ADDM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../01_getting_started/">Getting started with ADDM.jl</a></li><li><a class="tocitem" href="../03_empirical_data/">Parameter estimation on empirical data</a></li><li><a class="tocitem" href="../04_model_comparison/">Model comparison</a></li></ul></li><li><a class="tocitem" href="../../apireference/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Likelihood computation in ADDM.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Likelihood computation in ADDM.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/aDDM-Toolbox/ADDM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/aDDM-Toolbox/ADDM.jl/blob/main/docs/src/tutorials/02_likelihood_computation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Likelihood-computation-in-ADDM.jl"><a class="docs-heading-anchor" href="#Likelihood-computation-in-ADDM.jl">Likelihood computation in ADDM.jl</a><a id="Likelihood-computation-in-ADDM.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood-computation-in-ADDM.jl" title="Permalink"></a></h1><p>How do we estimate parameters? We choose a measure to quantify the difference between observed/empirical data and data that would be generated</p><p>For sequential sampling models these can be ...</p><p>A very common metric in all kinds of applications is likelihood</p><p>What is the likelihood in the context of sequential sampling models? It is the probability of observing the endorsed choice <em>at the observed response time</em>. This second part is what makes these models powerful. This is what we mean by the &quot;joint&quot; modeling of choice and response times.</p><p>So how do we calculate the likelihood for sequential sampling models? There are a few ways</p><ul><li>The analytical solution of the Wiener First Passage Time distribution</li><li>Trialwise simulations</li><li>Approximate Bayesian Computation</li><li>Solving the Fokker Planck Equation</li></ul><p>The likelihood functions in <code>ADDM.jl</code> use the last method.</p><p>Briefly, the FPE describes how a probability distribution changes over time. Since it is an expression of change, formally it is written as a partial differential equation. We&#39;ll skip the details of the math here but for an in depth dive, please see Shinn et al.</p><p>Here, we&#39;ll try to keep things intuitive. </p><p>[ADD Gabi&#39;s supplementary figure here]</p><p>Ok so what is the effect of the discretization step sizes (in both time and space)</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using ADDM, CSV, DataFrames, DataFramesMeta</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Plots, StatsPlots, Random, Plots.PlotMeasures</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Random.seed!(38435)</code><code class="nohighlight hljs ansi" style="display:block;">Random.TaskLocalRNG()</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; MyModel = ADDM.define_model(d = 0.007, σ = 0.03, θ = .6, barrier = 1,
                              decay = 0, nonDecisionTime = 100, bias = 0.0)</code><code class="nohighlight hljs ansi" style="display:block;">ADDM.aDDM(Dict{Symbol, Any}(:nonDecisionTime =&gt; 100, :σ =&gt; 0.03, :d =&gt; 0.007, :bias =&gt; 0.0, :barrier =&gt; 1, :decay =&gt; 0, :θ =&gt; 0.6, :η =&gt; 0.0))</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data_path = &quot;../../../data/&quot;</code><code class="nohighlight hljs ansi" style="display:block;">&quot;../../../data/&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = ADDM.load_data_from_csv(data_path * &quot;stimdata.csv&quot;, data_path * &quot;fixations.csv&quot;; stimsOnly = true);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nTrials = 1400;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; MyStims = (valueLeft = reduce(vcat, [[i.valueLeft for i in data[j]] for j in keys(data)])[1:nTrials], valueRight = reduce(vcat, [[i.valueRight for i in data[j]] for j in keys(data)])[1:nTrials]);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; vDiffs = sort(unique([x.valueLeft - x.valueRight for x in data[&quot;1&quot;]]));</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; MyFixationData = ADDM.process_fixations(data, fixDistType=&quot;fixation&quot;, valueDiffs = vDiffs);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; MyArgs = (timeStep = 10.0, cutOff = 20000, fixationData = MyFixationData);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; SimData = ADDM.simulate_data(MyModel, MyStims, ADDM.aDDM_simulate_trial, MyArgs);</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>We can look at a few things. </p><p>Save intermediate likelihoods for all trials with stepSize = .1 vs .01 for the correct and incorrect parameters</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; param_grid = [(d = 0.007, sigma = 0.03, theta = 0.6), (d = 0.007, sigma = 0.05, theta = 0.6)];</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; output_large = ADDM.grid_search(SimData, param_grid, ADDM.aDDM_get_trial_likelihood, Dict(:η=&gt;0.0, :barrier=&gt;1, :decay=&gt;0, :nonDecisionTime=&gt;100, :bias=&gt;0.0), likelihood_args = (timeStep = 10.0, stateStep = 0.1), save_intermediate_likelihoods = true , intermediate_likelihood_path=&quot;./outputs/&quot;, intermediate_likelihood_fn=&quot;large_stateStep_likelihoods&quot;);</code><code class="nohighlight hljs ansi" style="display:block;">(d = 0.007, sigma = 0.03, theta = 0.6)
(d = 0.007, sigma = 0.05, theta = 0.6)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; output_small = ADDM.grid_search(SimData, param_grid, ADDM.aDDM_get_trial_likelihood, Dict(:η=&gt;0.0, :barrier=&gt;1, :decay=&gt;0, :nonDecisionTime=&gt;100, :bias=&gt;0.0), likelihood_args = (timeStep = 10.0, stateStep = 0.01), save_intermediate_likelihoods = true, intermediate_likelihood_path=&quot;./outputs/&quot;, intermediate_likelihood_fn=&quot;small_stateStep_likelihoods&quot;);</code><code class="nohighlight hljs ansi" style="display:block;">(d = 0.007, sigma = 0.03, theta = 0.6)
(d = 0.007, sigma = 0.05, theta = 0.6)</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; fns = [&quot;large&quot;, &quot;small&quot;];</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; trial_likelihoods_for_sigmas = DataFrame();</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for fn in fns
         trial_likelihoods = DataFrame(CSV.File(&quot;./outputs/&quot;* fn *&quot;_stateStep_likelihoods.csv&quot;, delim=&quot;,&quot;))
         cur_tlfs = unstack(trial_likelihoods, :trial_num, :sigma, :likelihood)
         cur_tlfs[!, :stateStep] .= fn * &quot; stateStep&quot;
         trial_likelihoods_for_sigmas = vcat(trial_likelihoods_for_sigmas, cur_tlfs)
       end</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rename!(trial_likelihoods_for_sigmas, [Symbol(0.05), Symbol(0.03)]  .=&gt; [:incorrect_sigma, :correct_sigma])</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">2800×4 DataFrame
  Row │ trial_num  correct_sigma  incorrect_sigma  stateStep
      │<span class="sgr90"> Int64      Float64?       Float64?         String
──────┼────────────────────────────────────────────────────────────
    1 │         1    1.48383e-7       0.0120331    large stateStep
    2 │         2    2.39784e-6       0.00291181   large stateStep
    3 │         3    0.000150916      7.10574e-5   large stateStep
    4 │         4    1.45702e-5       0.00129004   large stateStep
    5 │         5    4.04995e-6       0.00635271   large stateStep
    6 │         6    1.01968e-5       0.00147724   large stateStep
    7 │         7    6.86946e-6       0.00969874   large stateStep
    8 │         8    4.32605e-7       0.0118807    large stateStep
  ⋮   │     ⋮            ⋮               ⋮                ⋮
 2794 │      1394    0.007474         0.00491241   small stateStep
 2795 │      1395    0.000365569      0.000358727  small stateStep
 2796 │      1396    0.00331776       0.00251966   small stateStep
 2797 │      1397    0.0171891        0.0101553    small stateStep
 2798 │      1398    0.00588413       0.00597161   small stateStep
 2799 │      1399    5.10415e-5       0.000129255  small stateStep
 2800 │      1400    1.72731e-5       1.93716e-8   small stateStep
</span><span class="sgr36">                                                  2785 rows omitted</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ax_lims = (minimum(vcat(trial_likelihoods_for_sigmas.incorrect_sigma, trial_likelihoods_for_sigmas.correct_sigma)), maximum(vcat(trial_likelihoods_for_sigmas.incorrect_sigma, trial_likelihoods_for_sigmas.correct_sigma)))</code><code class="nohighlight hljs ansi" style="display:block;">(9.881590029393893e-13, 0.034696770446922764)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @df trial_likelihoods_for_sigmas scatter(:correct_sigma, :incorrect_sigma,
                                                 xlabel = &quot;Likelihoods for true parameters&quot;,
                                                 ylabel = &quot;Likelihoods for incorrect parameters&quot;,
                                                 lim = ax_lims,
                                                 group = :stateStep,
                                                 m = (0.5, [:x :+], 4))</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=2}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Plots.abline!(1, 0, line=:dash, color=:black, label=&quot;&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code></pre><p>Pick a few trials where the likelihoods differ a lot between the correct and incorrect parameters. Use the debug option in the <code>aDDM_get_trial_likelihood</code> to plot the propogation of the probability distribution across timeSteps</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; # make new column for the difference in likelihoods for correct vs incorrect sigma
       @transform!(trial_likelihoods_for_sigmas, :diff_likelihood = :incorrect_sigma - :correct_sigma)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">2800×5 DataFrame
  Row │ trial_num  correct_sigma  incorrect_sigma  stateStep        diff_likel ⋯
      │<span class="sgr90"> Int64      Float64?       Float64?         String           Float64    ⋯
──────┼─────────────────────────────────────────────────────────────────────────
    1 │         1    1.48383e-7       0.0120331    large stateStep      0.0120 ⋯
    2 │         2    2.39784e-6       0.00291181   large stateStep      0.0029
    3 │         3    0.000150916      7.10574e-5   large stateStep     -7.9858
    4 │         4    1.45702e-5       0.00129004   large stateStep      0.0012
    5 │         5    4.04995e-6       0.00635271   large stateStep      0.0063 ⋯
    6 │         6    1.01968e-5       0.00147724   large stateStep      0.0014
    7 │         7    6.86946e-6       0.00969874   large stateStep      0.0096
    8 │         8    4.32605e-7       0.0118807    large stateStep      0.0118
  ⋮   │     ⋮            ⋮               ⋮                ⋮                ⋮   ⋱
 2794 │      1394    0.007474         0.00491241   small stateStep     -0.0025 ⋯
 2795 │      1395    0.000365569      0.000358727  small stateStep     -6.8419
 2796 │      1396    0.00331776       0.00251966   small stateStep     -0.0007
 2797 │      1397    0.0171891        0.0101553    small stateStep     -0.0070
 2798 │      1398    0.00588413       0.00597161   small stateStep      8.7479 ⋯
 2799 │      1399    5.10415e-5       0.000129255  small stateStep      7.8214
 2800 │      1400    1.72731e-5       1.93716e-8   small stateStep     -1.7253
</span><span class="sgr36">                                                  1 column and 2785 rows omitted</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # order by that difference column
       @orderby(trial_likelihoods_for_sigmas, -:diff_likelihood)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">2800×5 DataFrame
  Row │ trial_num  correct_sigma  incorrect_sigma  stateStep        diff_likel ⋯
      │<span class="sgr90"> Int64      Float64?       Float64?         String           Float64    ⋯
──────┼─────────────────────────────────────────────────────────────────────────
    1 │      1233     8.09688e-6        0.0219871  large stateStep        0.02 ⋯
    2 │       444     3.97583e-5        0.0216049  large stateStep        0.02
    3 │       346     1.16532e-5        0.0211799  large stateStep        0.02
    4 │       239     5.36272e-6        0.0209361  large stateStep        0.02
    5 │        70     9.63289e-6        0.0208319  large stateStep        0.02 ⋯
    6 │      1252     5.69004e-5        0.0206495  large stateStep        0.02
    7 │       974     5.89832e-6        0.020446   large stateStep        0.02
    8 │       920     2.32335e-5        0.0201914  large stateStep        0.02
  ⋮   │     ⋮            ⋮               ⋮                ⋮                ⋮   ⋱
 2794 │       321     0.0312285         0.019051   small stateStep       -0.01 ⋯
 2795 │       473     0.0311652         0.0188292  small stateStep       -0.01
 2796 │      1168     0.0268984         0.0142614  small stateStep       -0.01
 2797 │       576     0.031971          0.0193236  small stateStep       -0.01
 2798 │       920     0.0324            0.0195744  small stateStep       -0.01 ⋯
 2799 │      1252     0.033072          0.0199997  small stateStep       -0.01
 2800 │       444     0.0346968         0.0210686  small stateStep       -0.01
</span><span class="sgr36">                                                  1 column and 2785 rows omitted</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Pick top 4 trials (or maybe just one)
       diff_trial_nums = [@orderby(trial_likelihoods_for_sigmas, -:diff_likelihood)[1,:trial_num]];</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # extract these from the data
       diff_trials = SimData[diff_trial_nums];</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>Plot probStates for each trial with small vs large stateStep for correct and incorrect model</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; # 2 x 2 plot
       # Rows are stepsize
       # Cols are models
       # Point is to show that likelihood value changes depending on stepsize
       # Colors must match across the four plots
       # Need a legend common to all
       # Why are the prStates plots with small stepsize so dark?
       # Because the values in each bin are very small.
       # They values in each bin are small because they are spread over 10 times as many bins.
       
       correct_model = MyModel</code><code class="nohighlight hljs ansi" style="display:block;">ADDM.aDDM(Dict{Symbol, Any}(:nonDecisionTime =&gt; 100, :σ =&gt; 0.03, :d =&gt; 0.007, :bias =&gt; 0.0, :barrier =&gt; 1, :decay =&gt; 0, :θ =&gt; 0.6, :η =&gt; 0.0))</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; incorrect_model = ADDM.define_model(d = 0.007, σ = 0.05, θ = .6, barrier = 1,
                       decay = 0, nonDecisionTime = 100, bias = 0.0)</code><code class="nohighlight hljs ansi" style="display:block;">ADDM.aDDM(Dict{Symbol, Any}(:nonDecisionTime =&gt; 100, :σ =&gt; 0.05, :d =&gt; 0.007, :bias =&gt; 0.0, :barrier =&gt; 1, :decay =&gt; 0, :θ =&gt; 0.6, :η =&gt; 0.0))</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Use aDDM_get_trial_likelihood with debug = true to get probStates and probUp and
       _, prStates_cm_ls, probUpCrossing_cm_ls, probDownCrossing_cm_ls = ADDM.aDDM_get_trial_likelihood(;model = correct_model, trial = diff_trials[1], timeStep = 10.0, stateStep = 0.1, debug = true)</code><code class="nohighlight hljs ansi" style="display:block;">(8.096878584830163e-6, [0.0 1.4162223974047374e-219 … 4.5375501916536726e-5 5.64498235556904e-5; 0.0 5.387086681319769e-178 … 0.0002423198877350506 0.00029231841421040135; … ; 0.0 5.387086681319769e-178 … 1.4099859512659723e-15 1.4126040809026992e-15; 0.0 1.4162223974047374e-219 … 1.3684657759181988e-17 1.3837550792246481e-17], [0.0, 0.0, 6.70149921320135e-156, 7.087036542227303e-86, 1.6139410862905446e-63, 7.464821845909303e-51, 2.2182839878088653e-43, 2.094138226781327e-38, 5.236959055598448e-34, 4.8231054108039294e-30  …  1.267190490285548e-19, 1.2894503164522814e-19, 1.3110902710467176e-19, 1.3320919648285724e-19, 1.3524383067785386e-19, 1.372113494518117e-19, 1.391103001426367e-19, 1.4093935606238425e-19, 1.4269731460022016e-19, 1.4438309504860458e-19], [0.0, 4.9515076262406455e-244, 2.1685601300235454e-123, 1.6492240486940793e-83, 1.6870259137695894e-63, 7.755150639451445e-51, 2.2189663008389924e-43, 2.0943788743629457e-38, 5.237223207725851e-34, 4.823194284941315e-30  …  7.505609144477151e-7, 1.0217140947623072e-6, 1.373187480033782e-6, 1.8237072234266757e-6, 2.395180385265431e-6, 3.1130170646161764e-6, 4.006454520241371e-6, 5.108879559884519e-6, 6.4581453345015735e-6, 8.096878584830163e-6])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; _, prStates_cm_ss, probUpCrossing_cm_ss, probDownCrossing_cm_ss = ADDM.aDDM_get_trial_likelihood(;model = correct_model, trial = diff_trials[1], timeStep = 10.0, stateStep = 0.01, debug = true)</code><code class="nohighlight hljs ansi" style="display:block;">(0.028885398072872725, [0.0 1.744544239159668e-240 … 0.009370587887350228 0.010008622186511761; 0.0 9.894476199717002e-236 … 0.010679842159748444 0.011378090042737841; … ; 0.0 9.894476199717002e-236 … 2.0546109509130694e-16 1.6802724809676982e-16; 0.0 1.744544239159668e-240 … 1.2059202835105619e-16 9.866872934728037e-17], [0.0, 0.0, 3.1074537990909176e-155, 2.6940961583584292e-86, 5.971191584301819e-63, 1.442723857625483e-50, 1.7863746745753075e-42, 1.0716523073648713e-36, 2.3289114232385493e-32, 5.537323386035338e-29  …  6.079078237972634e-16, 5.084327893968827e-16, 4.23841285761508e-16, 3.5223778618277015e-16, 2.918862457215349e-16, 2.4121925347125624e-16, 1.9883866194647715e-16, 1.635102025095995e-16, 1.3415409104564006e-16, 1.0983318369739702e-16], [0.0, 6.352273120200567e-244, 3.8941438558893146e-123, 7.771826705249733e-83, 1.145074231262161e-62, 1.4812933631337436e-50, 1.7878890866409846e-42, 1.07169128985487e-36, 2.3289169675569822e-32, 5.537324667351102e-29  …  0.009318895723409134, 0.01125648405916716, 0.013353795394029649, 0.015575334296304385, 0.017878522831477173, 0.020215554135312154, 0.02253553646144521, 0.024786766704574848, 0.026918974983904626, 0.028885398072872725])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; _, prStates_im_ls, probUpCrossing_im_ls, probDownCrossing_im_ls = ADDM.aDDM_get_trial_likelihood(;model = incorrect_model, trial = diff_trials[1], timeStep = 10.0, stateStep = 0.1, debug = true)</code><code class="nohighlight hljs ansi" style="display:block;">(0.021987061640161887, [0.0 1.2399969806749259e-79 … 0.07217573149876846 0.07310174112197138; 0.0 1.154252249363737e-64 … 0.09164977919878514 0.09175558405071996; … ; 0.0 1.154252249363737e-64 … 4.751285941610749e-6 4.371841484607425e-6; 0.0 1.2399969806749259e-79 … 1.0480386951859534e-6 9.664937489738841e-7], [0.0, 0.0, 2.4324021480871978e-50, 3.3176367442155516e-31, 7.084939677813314e-24, 1.8699208205300152e-19, 1.553045998361747e-16, 1.7271799204097056e-14, 6.641992773763435e-13, 1.2197787702440446e-11  …  1.8124911993734878e-7, 1.686087238287205e-7, 1.5665951926836585e-7, 1.4538952591924031e-7, 1.347827411859745e-7, 1.2481993826473834e-7, 1.1547936810604119e-7, 1.0673737298300091e-7, 9.856891922899501e-8, 9.09480564811275e-8], [0.0, 2.7299456810336713e-89, 1.0048148485215877e-45, 3.517254750406806e-31, 7.085819835541814e-24, 1.8699221232567682e-19, 1.5530460310106876e-16, 1.727179923036559e-14, 6.641992774553914e-13, 1.2197787702574234e-11  …  0.01588606443378179, 0.016846946760318445, 0.017751360335102048, 0.018591307843201125, 0.01936002818584016, 0.020052032684701092, 0.020663108295115997, 0.02119029198870168, 0.021631820742851415, 0.021987061640161887])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; _, prStates_im_ss, probUpCrossing_im_ss, probDownCrossing_im_ss = ADDM.aDDM_get_trial_likelihood(;model = incorrect_model, trial = diff_trials[1], timeStep = 10.0, stateStep = 0.01, debug = true)</code><code class="nohighlight hljs ansi" style="display:block;">(0.022305126747130366, [0.0 7.9982564570212e-88 … 0.005216831420670731 0.0052639439009065335; 0.0 4.1146340993609204e-86 … 0.005859498037266892 0.005909414397077732; … ; 0.0 4.1146340993609204e-86 … 4.479882839244358e-8 4.101186108576121e-8; 0.0 7.9982564570212e-88 … 3.41865500053913e-8 3.129861099982578e-8], [0.0, 0.0, 1.565477220520794e-47, 3.7793767355441087e-31, 7.61969231725933e-24, 1.8720057888854625e-19, 1.6065419694459116e-16, 2.016714653098622e-14, 7.561788857042856e-13, 1.2594522317566444e-11  …  1.6662805238180172e-7, 1.5336590351543918e-7, 1.4104221982048458e-7, 1.2960910414077459e-7, 1.1901786301281752e-7, 1.0921976816471286e-7, 1.0016666128903639e-7, 9.181142628157331e-8, 8.410835011511294e-8, 7.701339074766706e-8], [0.0, 2.7536241186061926e-89, 1.0442437918812787e-45, 3.8218791928155823e-31, 7.619852822970566e-24, 1.8720061426414794e-19, 1.6065419790751846e-16, 2.016714653998766e-14, 7.561788857493001e-13, 1.2594522317717416e-11  …  0.01714736728755824, 0.01804283705485059, 0.018867528653376094, 0.019615191643015152, 0.02028098628776083, 0.020861451858816753, 0.0213544466109697, 0.021759065261115422, 0.022075539514176477, 0.022305126747130366])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; likMax = maximum(vcat(probUpCrossing_cm_ls, probDownCrossing_cm_ls, probUpCrossing_cm_ss, probDownCrossing_cm_ss, probUpCrossing_im_ls, probDownCrossing_im_ls, probUpCrossing_im_ss, probDownCrossing_im_ss))</code><code class="nohighlight hljs ansi" style="display:block;">0.028885398072872725</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; likelihoodLims = (0, likMax);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; prStateLims = (0, 0.05);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; p1 = state_space_plot(prStates_cm_ls, probUpCrossing_cm_ls, probDownCrossing_cm_ls, 10, 0.1, likelihoodLims, prStateLims);</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `state_space_plot` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; p2 = state_space_plot(prStates_cm_ss, probUpCrossing_cm_ss, probDownCrossing_cm_ss, 10, 0.01, likelihoodLims, prStateLims);</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `state_space_plot` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; p3 = state_space_plot(prStates_im_ls, probUpCrossing_im_ls, probDownCrossing_im_ls, 10, 0.1, likelihoodLims, prStateLims);</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `state_space_plot` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; p4 = state_space_plot(prStates_im_ss, probUpCrossing_im_ss, probDownCrossing_im_ss, 10, 0.01, likelihoodLims, prStateLims);</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `state_space_plot` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot_array = Any[];</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; push!(plot_array, p1);</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `p1` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; push!(plot_array, p2);</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `p2` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; push!(plot_array, p3);</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `p3` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; push!(plot_array, p4);</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `p4` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(plot_array...)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=0}</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Monday 29 April 2024 22:23">Monday 29 April 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
